[www]
; User and group for the FPM process
; These should match the user created in the Dockerfile
user = ${APP_USER}
group = ${APP_GROUP}

; Address to listen on.
; 127.0.0.1:9000 is safer if only accessed by a local web server (e.g., Nginx in another container)
; 0.0.0.0:9000 allows connections from any IP (useful for direct exposure or complex Docker networks)
; Use 127.0.0.1 for better security with HEALTHCHECK below.
listen = 127.0.0.1:9000
listen.owner = ${APP_USER}
listen.group = ${APP_GROUP}
listen.mode = 0660

; Process manager settings (adjust based on expected load and server resources)
pm = dynamic
pm.max_children = 10
pm.start_servers = 2
pm.min_spare_servers = 1
pm.max_spare_servers = 3
pm.max_requests = 500 ; Respawn processes after handling 500 requests to prevent memory leaks

; Health check / Status endpoints
; Used by Docker HEALTHCHECK and potentially monitoring tools
pm.status_path = /status
ping.path = /ping
ping.response = pong

; Logging
catch_workers_output = yes
php_admin_flag[log_errors] = on
php_admin_value[error_log] = /dev/stderr ; Log errors to container log

; Environment variables
; Pass environment variables from the container to FPM/PHP processes
; Clear these if you manage environment variables differently (e.g., .env files)
clear_env = no
env[APP_ENV] = ${APP_ENV}
env[APP_USER] = ${APP_USER}
env[APP_GROUP] = ${APP_GROUP}
; Add other essential ENV vars needed by your application here
; env[DATABASE_URL] = ${DATABASE_URL} ; Be careful with secrets in env vars